---
#title: "Rhizobia whole-genome sequencing"
output:
  pdf_document: default
  html_document: default
#date: "2023-08-30"
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = F)
library(tidyverse)
library(knitr)
library(janitor)
source(here::here("analysis/00-metadata.R"))
```


## Rhizobia whole-genome sequencing 

```{r}
isolates_rhizo <- read_csv(paste0(folder_data, "temp/02-isolates_rhizo.csv"), show_col_types = F)
isolates_RDP <- read_csv(paste0(folder_data, "temp/02-isolates_RDP.csv"), show_col_types = F)
```

```{r}
# Isolates included in the first batch of plasmidsaurus
isolates_seq1 <- isolates_rhizo %>%
    select(exp_id, id, family, genus) %>%
    filter(id != 44) %>% 
    mutate(seq_batch = 1)
# Isolates that will be included in the second batch
isolate_seq2 <- isolates_RDP %>%
    clean_names() %>% 
    left_join(isolates_seq1, by = join_by(exp_id, id, family, genus)) %>%
    filter(is.na(seq_batch)) %>%
    filter(genus == "Ensifer") %>% 
    select(exp_id, id, family, genus) %>% 
    mutate(genome_id = 20:37) 

```

```{r}
# Prepare the Plasmidsaurus sequencing submission 
isolate_seq2 %>%
    select(genome_id, exp_id, id) %>%
    kable()
```

```{r}
isolate_seq2 %>%
    select(genome_id, exp_id, id) %>% 
    write_csv(here::here("protocols/20231122_plasmidsaurus.csv"), col_names = F)
```


1. Prepare cell pellets
    a. Pellet the cells by centrifugation and remove as much supernatant as possible.
        - We require the equivalent of 8-12 OD600 or 4-6 x 109 cells (e.g. 8-12 mL culture at 1.0 OD600).
        - A **compact cell pellet** with all the supernatant removed (e.g. E. coli pellets) should weigh approximately **15 mg**.
        - A **wet cell pellet** where supernatant cannot be all removed without disturbing the pellet (e.g. Streptococcus sp. pellets) should be approximately **30-50 mg**.
        - Please DO NOT send more than 50 mg of material or there will be too many cells to be protected from degradation by the DNA/RNA Shield.
    b. Resuspend (wash) the pellet in 1 mL PBS, then pellet again and remove supernatant.
    c. Resuspend the final pellet in 0.5 mL of Zymo 1X DNA/RNA Shield in a **2 mL screw cap tube**.

2. Submit sequencing order
    - Please place an order, either for **Standard with extraction** (up to 7 Mb) or **Big with extraction** (7-12 Mb).
    - When filling out your sample names, please add either a plus (+) or a minus (-) at the end of each sample name to indicate whether each strain is gram positive or gram negative. Not doing so will cause a processing delay for your order, as we need this information directly from you.
    - Please label each 2 mL screw cap tube with the **order code, sample number, and the plus (+) or a minus (-)**. For example, "X2X1-" would indicate order code X2X, sample 1, gram negative.

3. Package samples
    -  To prevent damage and leakage of the tubes during shipment, please place the screw cap tubes in a rigid container such as a falcon tube or tube box before shipping. For orders of more than 10 samples, please put the tubes in a tube box and load the samples row by row in numerical order as this greatly reduces the handling time when receiving your samples. Please send samples at room temperature.








